(function(window,undefiend){var Speak=function(obj){return new Speak.prototype.init(obj)};Speak.prototype={constructor:Speak,version:"2020-08-17 v2",page:1,total_page:1,per_page:3,owner:"antmoe",repo:"speak",total_count:0,text:[],defaultLabelName:"Default",defaultLabelColor:"#ffc107",nickname:"XiaoKangðŸ¦„",highlightcss:"https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.1/styles/monokai-sublime.min.css",init:function(obj){for(let i in obj){this[i]=obj[i]}console.log("\n %c XiaoKang's Speak"+this.version+" %c https://docs.tzki.cn/Speak \n","color: #fff; background: #4285f4; padding:5px 0;","background: #66CCFF; padding:5px 0;");Speak.setHead(this,Speak.getPageSpeak(this));Speak.bindBtn(this);return this},};Speak.extend=Speak.prototype.extend=function(obj){for(var key in obj){this[key]=obj[key]}};Speak.extend({setHead:function(_this){Speak.noRefer();Speak.loadingCss();$.getScript("https://cdn.bootcss.com/highlight.js/9.18.1/highlight.min.js");$.getScript("https://cdn.jsdelivr.net/npm/marked/marked.min.js")},noRefer:function(){$("head").append('<meta name="referrer" content="no-referrer" />')},loadingCss:function(){$("head").append("<style>.loader{width:150px;height:150px;margin:0 auto}svg{width:90%;fill:none}.load{transform-origin:50% 50%;stroke-dasharray:570;stroke-width:20px}.load.one{stroke:#554d73;animation:load 1.5s infinite}.load.two{stroke:#a496a4;animation:load 1.5s infinite;animation-delay:.1s}.load.three{stroke:#a5a7bb;animation:load 1.5s infinite;animation-delay:.2s}.point{animation:bounce 1s infinite ease-in-out}.point.one{fill:#a5a7bb;animation-delay:0s}.point.two{fill:#a496a4;animation-delay:.1s}.point.three{fill:#554d73;animation-delay:.2s}@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-20px)}}@keyframes load{0%{stroke-dashoffset:570}50%{stroke-dashoffset:530}100%{stroke-dashoffset:570;transform:rotate(360deg)}}</style>")},loading:function(){$(".is-container").html(`<div class="loader"><svg viewBox="0 0 120 120"version="1.1"xmlns="http://www.w3.org/2000/svg"><circle class="load one"cx="60"cy="60"r="40"></circle><circle class="load two"cx="60"cy="60"r="40"></circle><circle class="load three"cx="60"cy="60"r="40"></circle><g><circle class="point one"cx="45"cy="70"r="5"></circle><circle class="point two"cx="60"cy="70"r="5"></circle><circle class="point three"cx="75"cy="70"r="5"></circle></g></svg></div>`)},});Speak.extend({getSpeak:function(_this){return $.ajax({url:"https://gitee.com/api/v5/repos/"+_this.owner+"/"+_this.repo+"/issues?state=open&sort=created&direction=desc&page="+_this.page+"&per_page="+_this.per_page+"&creator="+_this.owner,type:"get",success:function(date,textStatus,request){_this.text=[];_this.total_count=request.getResponseHeader("total_count");_this.total_page=Math.ceil(_this.total_count/_this.per_page);if(date){for(let i in date){var temp={};temp.comments=date[i]["comments"];temp.body=Speak.getBody(date[i]["body"]);temp.labels=Speak.getLabels(_this,date[i]["labels"]);temp.html_url=date[i]["html_url"];_this.text.push(temp)}}else{return}},})},bindBtn:function(_this){$(".prev").click(function(e){e.preventDefault();_this.page-=1;Speak.getPageSpeak(_this)});$(".next").click(function(e){e.preventDefault();_this.page+=1;Speak.getPageSpeak(_this)})},getPageSpeak:function(_this){Speak.loading();Speak.getSpeak(_this).then(()=>Speak.createSpeak(_this))},});Speak.extend({createSpeak:function(_this){let content="";var text=_this.text;for(let i in text){content+=`${text[i].labels}<div class="markdown about">${text[i].body}</div></div>`}$(".is-container").html(content);Speak.createPage(_this)},createPage:function(_this){if(_this.total_page!=1&&_this.page==1){$(".next").show()}else if(_this.page==_this.total_page&&_this.page!=1){$(".next").hide()}else if(_this.page<_this.total_page){$(".next").show()}else if(_this.total_page==1){$(".next").hide();$(".btn-group").hide()}if(_this.page>1){$(".prev").show()}else{$(".prev").hide()}},});Speak.extend({getFontColor:function(color){var reg=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;String.prototype.colorRgb=function(){var sColor=this.toLowerCase();if(sColor&&reg.test(sColor)){if(sColor.length===4){var sColorNew="#";for(var i=1;i<4;i+=1){sColorNew+=sColor.slice(i,i+1).concat(sColor.slice(i,i+1))}sColor=sColorNew}var sColorChange=[];for(var i=1;i<7;i+=2){sColorChange.push(parseInt("0x"+sColor.slice(i,i+2)))}return"RGB("+sColorChange.join(",")+")"}else{return sColor}};var flag="white";var rgbColor=color.colorRgb();rgbColor=rgbColor.replace("RGB(","");rgbColor=rgbColor.replace(")","");var temp=rgbColor.split(",");if(parseInt(temp[0])+parseInt(temp[1])+parseInt(temp[2])>450){flag="black"}return flag},getLabels:function(_this,labels){var defaultLabel="";var name=_this.defaultLabel;var color=_this.defaultLabelColor;if(labels.length){name=labels[0].name;color=Speak.getFontColor(labels[0].color)}defaultLabel+=`<div class="segment"style="border-color: #${labels[0].color}"><div class="label"style="color: #${color};background:#${labels[0].color};"><span>${name}</span></div>`;return defaultLabel},getBody:function(body){var rendererMD=new marked.Renderer();marked.setOptions({highlight:function(code){return hljs.highlightAuto(code).value},});rendererMD.image=function(url,title,text){return`<a style="cursor: zoom-in"data-caption="${text}"data-fancybox="gallery"href=${url}><img class="lazyload"src="${url}"data-src=${url}alt="${text}"></a>`};rendererMD.table=function(head,body){return`<div class='table-wrapper'><table><thead>${head}</thead><tbody>${body}</tbody></table></div>`};return marked(body,{renderer:rendererMD})},});Speak.prototype.init.prototype=Speak.prototype;window.Speak=Speak})(window);